alias: Outfit Notification
description: Advanced clothing suggestions with multiple weather factors
triggers:
  - at: "21:00:00"
    trigger: time
conditions: []
actions:
  - variables:
      temp_min: >-
        {{ state_attr('sensor.ims_forecast_day1', 'minimum_temperature')['value'] | float }}
      temp_max: >-
        {{ state_attr('sensor.ims_forecast_day1', 'maximum_temperature')['value'] | float }}
      feels_like: >-
        {{ state_attr('sensor.ims_forecast_day1', '12:00')['temperature']['value'] | float }}
      humidity: "{{ states('sensor.ims_humidity') | float(0) }}"
      condition: >-
        {{ state_attr('sensor.ims_forecast_day1', '12:00')['weather']['value'] }}
      uv: >-
        {{ state_attr('sensor.ims_forecast_day1', 'maximum_uvi')['value'] | float(0) }}
      ntfy_icon: "{{ state_attr('sensor.ims_forecast_day1', '12:00')['weather']['icon'] }}"
      weather_icon: >
        {% if 'rain' in condition or '×’×©×' in condition %} ðŸŒ§ï¸
        {% elif 'snow' in condition or '×©×œ×’' in condition %} â„ï¸
        {% elif 'cloud' in condition or '×ž×¢×•× ×Ÿ' in condition %} â˜ï¸
        {% elif 'thunder' in condition or 'lightning' in condition or '×¨×¢×ž×™×' in condition or '×‘×¨×§×™×' in condition %} â›ˆï¸
        {% elif 'wind' in condition or '×¨×•×—' in condition %} ðŸ’¨
        {% elif 'partlycloudy' in condition or '×ž×¢×•× ×Ÿ ×—×œ×§×™×ª' in condition %} â›…
        {% elif feels_like > 30 %} ðŸ”¥
        {% elif feels_like < 10 %} ðŸ¥¶
        {% else %} â˜€ï¸
        {% endif %}
      outfit_msg: >
        ×˜×ž×¤×¨×˜×•×¨×” ×ž×—×¨: {{ temp_min }}Â°C - {{ temp_max }}Â°C (×ž×¨×’×™×© ×›×ž×•: {{ feels_like }}Â°C)

        ×‘×™×’×•×“:
        {% if feels_like < 5 %} â€¢ ×ž×¢×™×œ ×¢×‘×” â€¢ ×’×•×¤×™×™×” ×—×ž×” â€¢ ×¡×•×•×“×¨ ×¢×‘×” â€¢ ×ž×’×¤×™×™× â€¢ ×›×¤×¤×•×ª, ×¦×¢×™×£ ×•×›×•×‘×¢
        {% elif feels_like < 12 %} â€¢ ×–'×§×˜ ×—× â€¢ ×¡×•×•×“×¨ ××• ×§×¤×•×¦'×•×Ÿ â€¢ ×ž×›× ×¡×™×™× ××¨×•×›×™× â€¢ × ×¢×œ×™×™× ×¡×’×•×¨×•×ª â€¢ ××¤×©×¨ ×œ×”×•×¡×™×£: ×¦×¢×™×£ ×§×œ
        {% elif feels_like < 18 %} â€¢ ×–×³×§×˜ ××• ×§×¨×“×™×’×Ÿ â€¢ ×—×•×œ×¦×” ××¨×•×›×” â€¢ ×ž×›× ×¡×™×™× ××¨×•×›×™× â€¢ × ×¢×œ×™×™× × ×•×—×•×ª
        {% elif feels_like < 24 %} â€¢ ×—×•×œ×¦×” ×§×¦×¨×” â€¢ ×ž×›× ×¡×™×™× ×§×¦×¨×™×/ ×—×¦××™×ª â€¢ ×¡× ×™×§×¨×¡ ××• ×¡× ×“×œ×™×
        {% else %} â€¢ ×œ×‘×•×© ×§×œ ×•× ×•×©× â€¢ ×©×•×¨×˜×¡ ××• ×—×¦××™×ª â€¢ ×¡× ×“×œ×™× ××• ×›×¤×›×¤×™× â€¢ ××¤×©×¨ ×œ×”×•×¡×™×£: ×ž×©×§×¤×™ ×©×ž×©
        {% endif %} 
      title_with_icon: |
        {{ weather_icon }} ×”×ž×œ×¦×ª ×œ×‘×•×© ×œ×ž×—×¨
  - action: notify.mobile_app_pixel_9_pro
    data:
      title: "{{ title_with_icon }}"
      message: "{{ outfit_msg }}"
      data:
        notification_icon: "{{ ntfy_icon }}"
